"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2406],{2406:(T,b,a)=>{a.d(b,{X:()=>S});var d=a(467),x=a(1413),f=a(3207),y=a(8359);class I extends y.yU{constructor(e,n){super()}schedule(e,n=0){return this}}const g={setInterval(s,e,...n){const{delegate:o}=g;return null!=o&&o.setInterval?o.setInterval(s,e,...n):setInterval(s,e,...n)},clearInterval(s){const{delegate:e}=g;return((null==e?void 0:e.clearInterval)||clearInterval)(s)},delegate:void 0};var O=a(7908);const M={now:()=>(M.delegate||Date).now(),delegate:void 0};class C{constructor(e,n=C.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,o){return new this.schedulerActionCtor(this,e).schedule(o,n)}}C.now=M.now;const G=new class R extends C{constructor(e,n=C.now){super(e,n),this.actions=[],this._active=!1}flush(e){const{actions:n}=this;if(this._active)return void n.push(e);let o;this._active=!0;do{if(o=e.execute(e.state,e.delay))break}while(e=n.shift());if(this._active=!1,o){for(;e=n.shift();)e.unsubscribe();throw o}}}(class w extends I{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var o;if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,n)),this.pending=!0,this.delay=n,this.id=null!==(o=this.id)&&void 0!==o?o:this.requestAsyncId(r,this.id,n),this}requestAsyncId(e,n,o=0){return g.setInterval(e.flush.bind(e,this),o)}recycleAsyncId(e,n,o=0){if(null!=o&&this.delay===o&&!1===this.pending)return n;null!=n&&g.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const o=this._execute(e,n);if(o)return o;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let i,o=!1;try{this.work(e)}catch(r){o=!0,i=r||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:n}=this,{actions:o}=n;this.work=this.state=this.scheduler=null,this.pending=!1,(0,O.o)(o,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}});var z=a(9974),D=a(8750),$=a(1853),N=a(4360),X=a(5225);const V=(0,$.L)(s=>function(n=null){s(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=n});function B(s){throw new V(s)}var P,t=a(4438),U=a(4934),Y=a(620),H=a(4796),K=a(4191),l=a(7125),J=a(1626),j=a(177),A=a(4341);function W(s,e){1&s&&(t.j41(0,"div",8),t.nrm(1,"ion-spinner",9),t.k0s())}function Q(s,e){if(1&s&&(t.j41(0,"ion-select-option",10),t.EFF(1),t.k0s()),2&s){const n=e.$implicit;t.Y8G("value",n.id),t.R7$(),t.SpI(" ",n.name," ")}}function Z(s,e){if(1&s){const n=t.RV6();t.j41(0,"ion-item")(1,"ion-label"),t.EFF(2,"Mostrar ocultos"),t.k0s(),t.j41(3,"ion-toggle",2),t.mxI("ngModelChange",function(i){t.eBV(n);const r=t.XpG();return t.DH7(r.showHiddenProducts,i)||(r.showHiddenProducts=i),t.Njj(i)}),t.bIt("ionChange",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.applyFilters())}),t.k0s()()}if(2&s){const n=t.XpG();t.R7$(3),t.R50("ngModel",n.showHiddenProducts)}}function q(s,e){1&s&&t.nrm(0,"ion-spinner",26)}function ee(s,e){if(1&s&&(t.j41(0,"p"),t.EFF(1),t.k0s()),2&s){const n=t.XpG().$implicit;t.R7$(),t.SpI("Proveedor: ",null==n?null:n.provider_name,"")}}function te(s,e){if(1&s){const n=t.RV6();t.j41(0,"ion-button",27),t.bIt("click",function(){t.eBV(n);const i=t.XpG().$implicit,r=t.XpG();return t.Njj(r.decreaseCount(i))}),t.nrm(1,"ion-icon",28),t.k0s()}if(2&s){const n=t.XpG().$implicit,o=t.XpG();t.Y8G("color",o.getButtonColor(n))}}function ne(s,e){1&s&&(t.j41(0,"p",29),t.EFF(1," \xa1Stock m\xe1ximo! "),t.k0s())}function oe(s,e){if(1&s){const n=t.RV6();t.j41(0,"ion-button",27),t.bIt("click",function(){t.eBV(n);const i=t.XpG().$implicit,r=t.XpG();return t.Njj(r.increaseCount(i))}),t.nrm(1,"ion-icon",30),t.k0s()}if(2&s){const n=t.XpG().$implicit,o=t.XpG();t.Y8G("color",o.getButtonColor(n))}}function ie(s,e){if(1&s){const n=t.RV6();t.j41(0,"ion-button",31),t.bIt("click",function(){t.eBV(n);const i=t.XpG().$implicit,r=t.XpG();return t.Njj(r.confirmAction(i))}),t.EFF(1," OK "),t.k0s()}if(2&s){const n=t.XpG().$implicit,o=t.XpG();t.Y8G("color",o.getButtonColor(n))}}function re(s,e){1&s&&(t.j41(0,"ion-reorder",32),t.nrm(1,"ion-icon",33),t.k0s())}function se(s,e){if(1&s){const n=t.RV6();t.j41(0,"ion-item-sliding")(1,"ion-item",11)(2,"div",12),t.bIt("click",function(){const i=t.eBV(n).$implicit,r=t.XpG();return t.Njj(r.isAdmin&&r.handleClick(i))}),t.j41(3,"ion-thumbnail",13),t.DNE(4,q,1,0,"ion-spinner",14),t.j41(5,"ion-img",15),t.bIt("ionImgDidLoad",function(){const i=t.eBV(n).$implicit,r=t.XpG();return t.Njj(r.setImageLoaded(i.product_id))})("ionError",function(i){const r=t.eBV(n).$implicit,c=t.XpG();return t.Njj(c.imageLoadError(i,r))}),t.k0s()(),t.j41(6,"ion-label")(7,"h2",16),t.EFF(8),t.k0s(),t.DNE(9,ee,2,1,"p",5),t.j41(10,"p"),t.EFF(11),t.k0s()()(),t.j41(12,"div",17)(13,"div",18),t.EFF(14),t.k0s(),t.j41(15,"div",19),t.DNE(16,te,2,1,"ion-button",20),t.j41(17,"div",21)(18,"span",22),t.EFF(19),t.k0s(),t.DNE(20,ne,2,0,"p",23),t.k0s(),t.DNE(21,oe,2,1,"ion-button",20),t.k0s(),t.DNE(22,ie,2,1,"ion-button",24),t.k0s(),t.DNE(23,re,2,0,"ion-reorder",25),t.k0s()()}if(2&s){const n=e.$implicit,o=t.XpG();t.R7$(),t.AVh("hidden-product",1===(null==n?null:n.hide_product)),t.R7$(),t.AVh("disabled-style",!o.isAdmin),t.R7$(2),t.Y8G("ngIf",!o.imageLoaded[n.product_id]),t.R7$(),t.FS9("alt",null==n?null:n.product_name),t.Y8G("src",(null==n?null:n.image_url)||"assets/product_placeholder.png"),t.R7$(3),t.JRh(null==n?null:n.product_name),t.R7$(),t.Y8G("ngIf",o.isAdmin),t.R7$(2),t.SpI("Precio a Cr\xe9dito: $",null==n?null:n.credit_price,""),t.R7$(3),t.SpI(" ",o.getDynamicText(n)," "),t.R7$(2),t.Y8G("ngIf",o.isAdmin),t.R7$(3),t.JRh(null==n?null:n.current_count),t.R7$(),t.Y8G("ngIf",(null==n?null:n.current_count)===(null==n?null:n.max_amount)&&o.isAdmin),t.R7$(),t.Y8G("ngIf",o.isAdmin),t.R7$(),t.Y8G("ngIf",o.isAdmin),t.R7$(),t.Y8G("ngIf",o.isAdmin&&(o.selectedSubCategory||o.allowGlobalReorder))}}class S{constructor(e,n,o,i,r,c,_,u,h){this.inventoryService=e,this.router=n,this.authService=o,this.cdr=i,this.imageState=r,this.alertController=c,this.loadingController=_,this.http=u,this.toastController=h,this.products=[],this.filteredProducts=[],this.displayedProducts=[],this.searchTerm="",this.isAdmin=!1,this.selectedCategory="",this.selectedSubCategory="",this.selectedSort="recent",this.categories=[],this.subCategories=[],this.loading=!1,this.imageLoaded={},this.lastClickTime=0,this.doubleClickDelay=300,this.allowGlobalReorder=!0,this.isReordering=!1,this.showHiddenProducts=!1,this.esGerente=!1}ngOnInit(){console.log("Inicializando p\xe1gina de inventario..."),this.isAdmin=this.authService.isAdmin();const e=this.authService.getUserId();e&&this.http.get(`https://muebleriasolaris.com/ionic-login/check_gerencia.php?userid=${e}`).subscribe(n=>{n.success?this.esGerente=n.isGerente:console.error("Error en la respuesta de la API:",n.error),console.log("\xbfEs gerente?",this.esGerente),console.log("ID de usuario:",e)},n=>{console.error("Error en la llamada HTTP:",n)}),this.loading=!0,Promise.all([this.fetchProducts(),this.fetchCategories(),this.fetchSubCategories()]).finally(()=>{this.loading=!1}),S.refreshData.subscribe(()=>{this.loading=!0,Promise.all([this.fetchProducts(),this.fetchCategories(),this.fetchSubCategories()]).finally(()=>{this.loading=!1})})}setImageLoaded(e){this.loading=!0,console.log("Imagen cargada para producto ID:",e),this.imageLoaded[e]=!0,this.cdr.detectChanges(),this.loading=!1}handleClick(e){console.log("Click detectado, llamando a viewProduct dos veces..."),this.viewProduct(e),setTimeout(()=>{this.viewProduct(e)},100)}handleReorder(e){var n=this;return(0,d.A)(function*(){n.isReordering=!0;const{from:o,to:i}=e.detail,r=[...n.displayedProducts],c=r.splice(o,1)[0];r.splice(i,0,c),n.displayedProducts=r;const _=yield n.loadingController.create({message:"Guardando orden..."});yield _.present();try{const u=r.map(m=>m.product_id),h=!n.selectedSubCategory;if(!(yield(0,f.s)(n.inventoryService.updateProductOrder({product_ids:u,sub_category_id:h?void 0:Number(n.selectedSubCategory),is_global:h}).pipe(function L(s,e){const{first:n,each:o,with:i=B,scheduler:r=(null!=e?e:G),meta:c=null}=function F(s){return s instanceof Date&&!isNaN(s)}(s)?{first:s}:"number"==typeof s?{each:s}:s;if(null==n&&null==o)throw new TypeError("No timeout provided.");return(0,z.N)((_,u)=>{let h,p,m=null,v=0;const k=E=>{p=(0,X.N)(u,r,()=>{try{h.unsubscribe(),(0,D.Tg)(i({meta:c,lastValue:m,seen:v})).subscribe(u)}catch(ae){u.error(ae)}},E)};h=_.subscribe((0,N._)(u,E=>{null==p||p.unsubscribe(),v++,u.next(m=E),o>0&&k(o)},void 0,void 0,()=>{null!=p&&p.closed||null==p||p.unsubscribe(),m=null})),!v&&k(null!=n?"number"==typeof n?n:+n-r.now():o)})}(5e3)))).success)throw new Error("Error en servidor");n.showToast("Orden guardado!"),r.forEach((m,v)=>{h?m.global_position=v:m.position_index=v}),n.products=n.products.map(m=>{const v=r.find(k=>k.product_id===m.product_id);return v?{...m,global_position:v.global_position,position_index:v.position_index}:m})}catch(u){console.error("Error:",u),n.showToast("Error al guardar. Recargando...","danger"),n.fetchProducts()}finally{_.dismiss(),e.detail.complete(),n.isReordering=!1,e.detail.complete(),setTimeout(()=>{n.cdr.detectChanges()},100)}})()}getReorderGroupClass(){return{"reorder-visible":this.isAdmin,reordering:this.isReordering}}showToast(e,n="success",o=2e3){var i=this;return(0,d.A)(function*(){console.log(`Toast: ${e}`,n),yield(yield i.toastController.create({message:e,duration:o,color:n,position:"top"})).present()})()}fetchProducts(){this.loading=!0;const e=this.selectedSubCategory?Number(this.selectedSubCategory):void 0;this.inventoryService.getProducts(this.searchTerm,e).subscribe(n=>{n&&n.success&&(this.products=n.data.map(o=>{const i=this.normalizeProduct(o);return i.current_count=i.current_stock,i}),this.products.sort((o,i)=>e?(null===o.position_index?1/0:o.position_index)-(null===i.position_index?1/0:i.position_index):(null===o.global_position?1/0:o.global_position)-(null===i.global_position?1/0:i.global_position)),this.filteredProducts=[...this.products],this.applyFilters(),this.loading=!1)},n=>{console.error("Error al obtener productos:",n),this.loading=!1})}assignValuesToProducts(){this.products.forEach(e=>{e.sub_category_id||(e.sub_category_id=null),e.category_id||(e.category_id=null)})}fetchCategories(){this.inventoryService.getCategories().subscribe(e=>{e.success&&(this.categories=e.data)},e=>{console.error("Error al obtener categor\xedas:",e)})}fetchSubCategories(){this.inventoryService.getSubCategories().subscribe(e=>{e.success&&(this.subCategories=e.data)},e=>{console.error("Error al obtener subcategor\xedas:",e)})}onSearchChange(e){console.log("T\xe9rmino de b\xfasqueda:",this.searchTerm);const n=this.normalizeText(this.searchTerm.toLowerCase());if(!n)return void this.applyFilters();const o=n.split(" ").filter(r=>r.length>0);this.filteredProducts=(this.selectedCategory||this.selectedSubCategory?this.filteredProducts:this.products).filter(r=>{const c=this.normalizeText(r.product_name.toLowerCase()),_=this.normalizeText(r.provider_name.toLowerCase()),u=r.product_id.toString();return o.every(h=>c.includes(h)||_.includes(h)||u.includes(h))}),console.log("Productos filtrados:",this.filteredProducts),this.displayedProducts=[],this.loadMoreProducts(),this.cdr.detectChanges()}normalizeText(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}applyFilters(){let e=[...this.products];if(this.selectedCategory){const o=Number(this.selectedCategory);e=e.filter(i=>i.category_id===o)}if(this.selectedSubCategory){const o=Number(this.selectedSubCategory);e=e.filter(i=>i.sub_category_id===o||!i.sub_category_id)}this.showHiddenProducts&&(e=e.filter(o=>1===o.hide_product)),e=e.sort((o,i)=>this.selectedSubCategory?(null===o.position_index?1/0:o.position_index)-(null===i.position_index?1/0:i.position_index):(null===o.global_position?1/0:o.global_position)-(null===i.global_position?1/0:i.global_position)),e.some(o=>this.selectedSubCategory?null!==o.position_index:null!==o.global_position)||("recent"===this.selectedSort?e=e.sort((o,i)=>new Date(i.updated_at).getTime()-new Date(o.updated_at).getTime()):"alphabetical"===this.selectedSort&&(e=e.sort((o,i)=>o.product_name.localeCompare(i.product_name)))),this.filteredProducts=e,this.displayedProducts=[],this.loadMoreProducts()}normalizeProduct(e){return this.imageLoaded[e.product_id]=!1,{image_url:e.image_url||"assets/product_placeholder.png",product_id:e.product_id||0,product_name:e.product_name||"Producto sin nombre",credit_price:e.credit_price||0,updated_at:e.updated_at||(new Date).toISOString(),category_id:e.category_id||null,current_count:e.current_stock||0,current_stock:e.current_stock||0,max_amount:e.max_amount||0,prov_price:e.prov_price||"0.00",provider_name:e.provider_name||"Proveedor desconocido",sub_category_id:e.sub_category_id||null,position_index:void 0!==e.position_index?e.position_index:null,global_position:void 0!==e.global_position?e.global_position:null,hide_product:void 0!==e.hide_product?e.hide_product:null}}imageLoadError(e,n){console.error("Error cargando imagen para producto:",n.product_id,e),e.target.src="assets/product_placeholder.png",this.imageLoaded[n.product_id]=!0,this.cdr.detectChanges()}loadMoreProducts(){this.displayedProducts=[...this.filteredProducts]}onCategoryChange(e){this.selectedCategory=e.detail.value,this.selectedSubCategory="",this.applyFilters()}onSubCategoryChange(e){this.selectedSubCategory=e.detail.value,this.applyFilters()}hasMoreProducts(){return this.displayedProducts.length<this.filteredProducts.length}viewProduct(e){console.log("M\xe9todo viewProduct ejecutado"),e&&e.product_id?(e.sub_category_id||(console.warn("El producto no tiene sub_category_id:",e),e.sub_category_id=null),console.log("Producto seleccionado:",e.product_id),console.log("Estado del producto:",e),this.router.navigate(["/producto",e.product_id])):console.error("El producto no est\xe1 completamente cargado o falta informaci\xf3n:",e)}increaseCount(e){var n=this;return(0,d.A)(function*(){e.current_count<e.max_amount?e.current_count+=1:yield n.presentAlert("L\xedmite alcanzado",`Has alcanzado el stock m\xe1ximo permitido: ${e.max_amount}`,"warning")})()}decreaseCount(e){var n=this;return(0,d.A)(function*(){e.current_count>0?e.current_count--:yield n.presentAlert("Acci\xf3n no permitida","No se puede disminuir, el contador ya est\xe1 en 0","warning")})()}presentAlert(e,n,o="warning"){var i=this;return(0,d.A)(function*(){yield(yield i.alertController.create({header:e,message:n,buttons:["OK"],cssClass:`custom-alert ${{success:"success",warning:"warning",error:"danger"}[o]}`,mode:"ios"})).present()})()}confirmAction(e){var n=this;return(0,d.A)(function*(){const o=e.current_count-e.current_stock;0!==o?yield(yield n.alertController.create({header:"Confirmar acci\xf3n",message:`\xbfEst\xe1s seguro de ${o>0?"aumentar":"reducir"} el stock en ${Math.abs(o)} unidades?`,buttons:[{text:"Cancelar",role:"cancel",cssClass:"secondary"},{text:"Confirmar",handler:()=>n.executeInventoryUpdate(e,o)}]})).present():yield n.presentAlert("Sin cambios","No se detectaron cambios en el inventario","warning")})()}executeInventoryUpdate(e,n){var o=this;return(0,d.A)(function*(){const i=yield o.presentLoading("Actualizando inventario...");try{o.inventoryService.updateInventory(e.product_id,n).subscribe({next:(r=(0,d.A)(function*(c){yield i.dismiss(),c.success?(e.current_stock=c.new_stock,e.current_count=c.new_stock,yield o.presentAlert("\xa1\xc9xito!",`Inventario actualizado correctamente. Nuevo stock: ${c.new_stock}`,"success"),yield o.reloadDataPreservingFilters()):yield o.presentAlert("Error",`No se pudo actualizar el inventario: ${c.message}`,"error")}),function(_){return r.apply(this,arguments)}),error:function(){var r=(0,d.A)(function*(c){yield i.dismiss(),yield o.presentAlert("Error",`Ocurri\xf3 un error al actualizar: ${c.message||"Error desconocido"}`,"error")});return function(_){return r.apply(this,arguments)}}()})}catch{yield i.dismiss(),yield o.presentAlert("Error","Ocurri\xf3 un error inesperado","error")}var r})()}reloadDataPreservingFilters(){var e=this;return(0,d.A)(function*(){const n={searchTerm:e.searchTerm,selectedCategory:e.selectedCategory,selectedSubCategory:e.selectedSubCategory,selectedSort:e.selectedSort},o=yield e.presentLoading("Actualizando lista...");try{yield e.fetchProducts(),e.searchTerm=n.searchTerm,e.selectedCategory=n.selectedCategory,e.selectedSubCategory=n.selectedSubCategory,e.selectedSort=n.selectedSort,e.applyFilters()}catch(i){console.error("Error al recargar datos:",i)}finally{yield o.dismiss()}})()}presentLoading(e){var n=this;return(0,d.A)(function*(){const o=yield n.loadingController.create({message:e,spinner:"crescent",translucent:!0});return yield o.present(),o})()}getButtonColor(e){return e.current_count>e.current_stock?"success":e.current_count<e.current_stock?"danger":"medium"}getDynamicText(e){return e.current_count>e.current_stock?"Agregar a Stock":e.current_count<e.current_stock?"Venta":e.current_count===e.current_stock?"Stock Disponible":"None"}initializeProducts(e){typeof e.current_stock<"u"?e.current_count=e.current_stock:(console.warn("current_stock no est\xe1 definido para el producto:",e),e.current_count=0)}onDrag(e,n){if(console.log("Evento ionDrag detectado"),!n||!n.product_id||!n.sub_category_id)return console.warn("El producto no est\xe1 completamente cargado:",n),void e.close();e.getSlidingRatio().then(o=>{console.log("Proporci\xf3n del deslizamiento (ratio):",o),o>1&&(console.log("Deslizamiento completado, ejecutando viewProduct..."),setTimeout(()=>{this.viewProduct(n),e.close()},100))}).catch(o=>{console.error("Error al obtener la proporci\xf3n del deslizamiento:",o)})}ionViewDidEnter(){var e,n;const o=this.router.getCurrentNavigation(),i=null==o||null===(e=o.extras)||void 0===e?void 0:e.state;null!=o&&null!==(n=o.extras)&&void 0!==n&&null!==(n=n.state)&&void 0!==n&&n.timestamp&&(this.fetchProducts(),this.fetchCategories(),this.fetchSubCategories()),null!=i&&i.updatedProduct&&this.actualizarProductoEnLista(i.updatedProduct)}actualizarProductoEnLista(e){const n=this.products.findIndex(o=>o.product_id===e.product_id);-1!==n&&(this.products[n].hide_product=e.hide_product,this.products=[...this.products])}}(P=S).refreshData=new x.B,P.\u0275fac=function(e){return new(e||P)(t.rXU(U.c),t.rXU(Y.Ix),t.rXU(H.u),t.rXU(t.gRc),t.rXU(K.S),t.rXU(l.hG),t.rXU(l.Xi),t.rXU(J.Qq),t.rXU(l.K_))},P.\u0275cmp=t.VBU({type:P,selectors:[["app-inventario"]],decls:18,vars:9,consts:[["class","loading-overlay",4,"ngIf"],["placeholder","Nombre o Proveedor",3,"ngModelChange","ionInput","ngModel"],[3,"ngModelChange","ionChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"ionItemReorder","disabled"],[4,"ngFor","ngForOf"],[1,"loading-overlay"],["name","crescent",1,"loading-spinner"],[3,"value"],["lines","full",1,"inventory-item"],[1,"left-info",3,"click"],["slot","start",1,"image-container"],["name","crescent","class","image-spinner",4,"ngIf"],[3,"ionImgDidLoad","ionError","src","alt"],[1,"product-name"],[1,"counter-container"],[1,"dynamic-text"],[1,"counter-controls"],["fill","clear","size","small",3,"color","click",4,"ngIf"],[1,"counter-value-container"],[1,"counter-value"],["class","warning-text",4,"ngIf"],["expand","block","size","small","class","confirm-button",3,"color","click",4,"ngIf"],["slot","end",4,"ngIf"],["name","crescent",1,"image-spinner"],["fill","clear","size","small",3,"click","color"],["name","remove-circle-outline"],[1,"warning-text"],["name","add-circle-outline"],["expand","block","size","small",1,"confirm-button",3,"click","color"],["slot","end"],["name","reorder-three-outline",1,"reorder-icon"]],template:function(e,n){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Inventario"),t.k0s()()(),t.j41(4,"ion-content"),t.DNE(5,W,2,0,"div",0),t.j41(6,"ion-list")(7,"ion-searchbar",1),t.mxI("ngModelChange",function(i){return t.DH7(n.searchTerm,i)||(n.searchTerm=i),i}),t.bIt("ionInput",function(i){return n.onSearchChange(i)}),t.k0s(),t.j41(8,"ion-item")(9,"ion-label"),t.EFF(10,"Subcategor\xeda"),t.k0s(),t.j41(11,"ion-select",2),t.mxI("ngModelChange",function(i){return t.DH7(n.selectedSubCategory,i)||(n.selectedSubCategory=i),i}),t.bIt("ionChange",function(){return n.applyFilters()}),t.j41(12,"ion-select-option",3),t.EFF(13,"Todas"),t.k0s(),t.DNE(14,Q,2,2,"ion-select-option",4),t.k0s()(),t.DNE(15,Z,4,1,"ion-item",5),t.j41(16,"ion-reorder-group",6),t.bIt("ionItemReorder",function(i){return n.handleReorder(i)}),t.DNE(17,se,24,17,"ion-item-sliding",7),t.k0s()()()),2&e&&(t.R7$(5),t.Y8G("ngIf",n.loading),t.R7$(2),t.R50("ngModel",n.searchTerm),t.R7$(4),t.R50("ngModel",n.selectedSubCategory),t.R7$(3),t.Y8G("ngForOf",n.subCategories),t.R7$(),t.Y8G("ngIf",n.esGerente),t.R7$(),t.HbH(n.getReorderGroupClass()),t.Y8G("disabled",!n.isAdmin||!n.selectedSubCategory&&!n.allowGlobalReorder),t.R7$(),t.Y8G("ngForOf",n.displayedProducts))},dependencies:[j.Sq,j.bT,A.BC,A.vS,l.Jm,l.W9,l.eU,l.iq,l.KW,l.uz,l.A7,l.he,l.nf,l.UB,l.p$,l.S1,l.Nm,l.Ip,l.w2,l.Zx,l.BC,l.BY,l.ai,l.hB,l.Je,l.Gw],styles:['@charset "UTF-8";ion-list[_ngcontent-%COMP%]{margin:10px;border-radius:15px;overflow:hidden;background-color:#fff;box-shadow:0 2px 8px #0000001a}ion-item[_ngcontent-%COMP%]{--background: #fff;margin:5px 0;border-radius:10px;padding:0 10px;display:flex;align-items:center;transition:transform .2s ease,box-shadow .2s ease}ion-thumbnail[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:10px;overflow:hidden}ion-img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%}ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#333;margin:0}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;color:#666;margin:2px 0}.product-price[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#444;margin-left:auto;display:flex;align-items:center;justify-content:center}@media (min-width: 768px){.counter-container[_ngcontent-%COMP%]{padding:0 0 10px}ion-list[_ngcontent-%COMP%]{max-width:700px;margin:20px auto}ion-item[_ngcontent-%COMP%]{--background: #f9f9f9;padding:15px}ion-thumbnail[_ngcontent-%COMP%]{width:100px;height:100px}ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem}.product-price[_ngcontent-%COMP%]{font-size:1.1rem}}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem;color:#666;margin:2px 0}ion-list.list-ios[_ngcontent-%COMP%]   ion-item.item[_ngcontent-%COMP%]   div.item-native[_ngcontent-%COMP%]{border-bottom:none}.counter-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-left:auto;flex-direction:column;justify-content:space-evenly;height:100%;padding:10px 0}.counter-container[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0}.small-text[_ngcontent-%COMP%]{font-size:.8rem;color:var(--ion-color-medium);text-align:center}.confirm-button[_ngcontent-%COMP%]{transition:transform .2s}.confirm-button[_ngcontent-%COMP%]:active{transform:scale(1.1)}.current-stk[_ngcontent-%COMP%]{display:flex;height:100%;justify-content:space-evenly;align-items:center}.dynamic-text[_ngcontent-%COMP%]{width:150px;text-align:center;font-size:.9rem;font-weight:700;min-height:1.5rem}.container-stock[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-evenly}.mid-two[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-around;height:100%}.inventory-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.counter-controls[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:10px}.counter-value-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;min-width:70px}.counter-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--ion-color-medium)}.stock-label[_ngcontent-%COMP%]{font-size:.8rem;color:var(--ion-color-medium)}.dynamic-text[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700;color:var(--ion-color-primary)}.confirm-button[_ngcontent-%COMP%]{width:100%;max-width:80px;margin-top:5px;transition:transform .2s}.confirm-button[_ngcontent-%COMP%]:active{transform:scale(1.05)}.confirm-button[_ngcontent-%COMP%]::navitve{color:#fff}.left-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;align-items:center;justify-content:flex-start}ion-thumbnail[_ngcontent-%COMP%]{padding:7px;margin-right:20px}@media (max-width: 450px){.left-info[_ngcontent-%COMP%]{flex-direction:column;align-items:center}ion-label[_ngcontent-%COMP%]{text-align:center}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.75rem;text-align:center}ion-list[_ngcontent-%COMP%]{max-width:700px;margin:10px auto 0}}ion-item.inventory-item[_ngcontent-%COMP%]::part(native){padding-left:0}.warning-text[_ngcontent-%COMP%]{color:red;font-size:.6rem;text-align:center;margin-top:5px}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1000;display:flex;justify-content:center;align-items:center;width:100%;height:100%;background-color:#ffffffb3}.loading-spinner[_ngcontent-%COMP%]{width:64px;height:64px;color:var(--ion-color-primary)}.image-container[_ngcontent-%COMP%]{position:relative;width:100px;height:100px;overflow:hidden}.image-container[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;opacity:1;display:block;transition:opacity .3s ease}.image-container[_ngcontent-%COMP%]   .image-spinner[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:32px;height:32px;z-index:2}ion-img[_ngcontent-%COMP%]{opacity:0;transition:opacity .3s ease-in-out}ion-img.img-loaded[_ngcontent-%COMP%]{opacity:1}.custom-alert[_ngcontent-%COMP%]{--backdrop-opacity: .6}.custom-alert.success[_ngcontent-%COMP%]{--background: var(--ion-color-success);--color: white}.custom-alert.warning[_ngcontent-%COMP%]{--background: var(--ion-color-warning);--color: black}.custom-alert.danger[_ngcontent-%COMP%]{--background: var(--ion-color-danger);--color: white}.custom-alert[_ngcontent-%COMP%]   .alert-button-group[_ngcontent-%COMP%]{justify-content:center}.custom-alert[_ngcontent-%COMP%]   .alert-button[_ngcontent-%COMP%]{color:inherit;font-weight:700}ion-reorder[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin-inline-end:16px;opacity:1!important;min-width:24px}ion-reorder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:24px;transition:all .2s ease}ion-reorder[_ngcontent-%COMP%]:active   ion-icon[_ngcontent-%COMP%], ion-reorder[_ngcontent-%COMP%]:hover   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary);transform:scale(1.1)}ion-reorder-group.reorder-group-enabled[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: var(--ion-color-light);transition:transform .2s ease;box-shadow:0 2px 8px #00000014}ion-reorder-group.reorder-group-enabled[_ngcontent-%COMP%]   ion-item.item-reorder-active[_ngcontent-%COMP%]{border-left:3px solid var(--ion-color-primary);box-shadow:0 4px 12px #0000001f}.ios[_ngcontent-%COMP%]   ion-reorder[_ngcontent-%COMP%]{margin-inline-end:12px}ion-item-sliding[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0}ion-item-sliding[_ngcontent-%COMP%]   ion-reorder[_ngcontent-%COMP%]{z-index:1}.inventory-item.hidden-product[_ngcontent-%COMP%]{--background: #f5f5f5;opacity:.8}.inventory-item.hidden-product[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%], .inventory-item.hidden-product[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666!important;font-style:italic}.inventory-item.hidden-product[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{filter:grayscale(70%)}.inventory-item.hidden-product[_ngcontent-%COMP%]   .counter-value[_ngcontent-%COMP%]{color:#666}.inventory-item[_ngcontent-%COMP%]:not(.hidden-product){--background: white}']})},4191:(T,b,a)=>{a.d(b,{S:()=>x});var d=a(4438);let x=(()=>{var f;class y{constructor(){}getImageUrl(g){return null!=g&&g.image_url?`${g.image_url}?t=${Date.now()}`:"assets/product_placeholder.png"}}return(f=y).\u0275fac=function(g){return new(g||f)},f.\u0275prov=d.jDH({token:f,factory:f.\u0275fac,providedIn:"root"}),y})()},3207:(T,b,a)=>{a.d(b,{s:()=>x});var d=a(9350);function x(f,y){const I="object"==typeof y;return new Promise((g,O)=>{let M,w=!1;f.subscribe({next:C=>{M=C,w=!0},error:O,complete:()=>{w?g(M):I?g(y.defaultValue):O(new d.G)}})})}}}]);