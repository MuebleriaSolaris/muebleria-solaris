"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9394],{9394:(I,g,s)=>{s.r(g),s.d(g,{InventarioPageModule:()=>k});var u=s(177),_=s(4341),c=s(4742),m=s(1671),n=s(4438),d=s(4934),f=s(4796);function p(e,a){if(1&e){const o=n.RV6();n.j41(0,"ion-button",17),n.bIt("click",function(){n.eBV(o);const i=n.XpG().$implicit,r=n.XpG();return n.Njj(r.decreaseCount(i))}),n.nrm(1,"ion-icon",18),n.k0s()}if(2&e){const o=n.XpG().$implicit,t=n.XpG();n.Y8G("color",t.getButtonColor(o))}}function h(e,a){1&e&&(n.j41(0,"p",19),n.EFF(1," \xa1Stock m\xe1ximo! "),n.k0s())}function v(e,a){if(1&e){const o=n.RV6();n.j41(0,"ion-button",17),n.bIt("click",function(){n.eBV(o);const i=n.XpG().$implicit,r=n.XpG();return n.Njj(r.increaseCount(i))}),n.nrm(1,"ion-icon",20),n.k0s()}if(2&e){const o=n.XpG().$implicit,t=n.XpG();n.Y8G("color",t.getButtonColor(o))}}function x(e,a){if(1&e){const o=n.RV6();n.j41(0,"ion-button",21),n.bIt("click",function(){n.eBV(o);const i=n.XpG().$implicit,r=n.XpG();return n.Njj(r.confirmAction(i))}),n.EFF(1," OK "),n.k0s()}if(2&e){const o=n.XpG().$implicit,t=n.XpG();n.Y8G("color",t.getButtonColor(o))}}function P(e,a){if(1&e){const o=n.RV6();n.j41(0,"ion-item-options",22),n.bIt("ionDrag",function(){n.eBV(o),n.XpG();const i=n.sdS(1),r=n.XpG();return n.Njj(r.onDrag(i))}),n.j41(1,"ion-item-option",23),n.bIt("click",function(){n.eBV(o);const i=n.XpG().$implicit,r=n.XpG();return n.Njj(r.viewProduct(i.product_id))}),n.EFF(2," Ver Art\xedculo "),n.k0s()()}}function C(e,a){if(1&e&&(n.j41(0,"ion-item-sliding",null,0)(2,"ion-item",3)(3,"div",4)(4,"ion-thumbnail",5),n.nrm(5,"ion-img",6),n.k0s(),n.j41(6,"ion-label")(7,"h2",7),n.EFF(8),n.k0s(),n.j41(9,"p"),n.EFF(10),n.k0s(),n.j41(11,"p"),n.EFF(12),n.k0s()()(),n.j41(13,"div",8)(14,"div",9),n.EFF(15),n.k0s(),n.j41(16,"div",10),n.DNE(17,p,2,1,"ion-button",11),n.j41(18,"div",12)(19,"span",13),n.EFF(20),n.k0s(),n.DNE(21,h,2,0,"p",14),n.k0s(),n.DNE(22,v,2,1,"ion-button",11),n.k0s(),n.DNE(23,x,2,1,"ion-button",15),n.k0s()(),n.DNE(24,P,3,0,"ion-item-options",16),n.k0s()),2&e){const o=a.$implicit,t=n.XpG();n.R7$(5),n.FS9("alt",o.product_name),n.R7$(3),n.JRh(o.product_name),n.R7$(2),n.SpI("Proveedor: ",o.provider_name,""),n.R7$(2),n.SpI("Precio a Cr\xe9dito: $",o.credit_price,""),n.R7$(3),n.SpI(" ",t.getDynamicText(o)," "),n.R7$(2),n.Y8G("ngIf",t.isAdmin),n.R7$(3),n.JRh(o.current_count),n.R7$(),n.Y8G("ngIf",o.current_count===o.max_amount),n.R7$(),n.Y8G("ngIf",t.isAdmin),n.R7$(),n.Y8G("ngIf",t.isAdmin),n.R7$(),n.Y8G("ngIf",t.isAdmin)}}const M=[{path:"",component:(()=>{var e;class a{constructor(t,i,r){this.inventoryService=t,this.router=i,this.authService=r,this.products=[],this.filteredProducts=[],this.searchTerm="",this.isAdmin=!1}ngOnInit(){this.isAdmin=this.authService.isAdmin(),this.fetchProducts()}fetchProducts(){this.inventoryService.getProducts(this.searchTerm).subscribe(t=>{t.success&&(this.products=t.data,this.filteredProducts=this.products,this.products.forEach(i=>this.initializeProducts(i)))},t=>{console.error("Error al obtener productos:",t)})}onSearchChange(t){const i=this.searchTerm.toLowerCase();this.filteredProducts=this.products.filter(r=>r.product_name.toLowerCase().includes(i)||r.provider_name.toLowerCase().includes(i)||r.product_id.toString().includes(i))}viewProduct(t){this.router.navigate(["/producto",t])}increaseCount(t){t.current_count<t.max_amount?(console.log("Se incrementa valor de: ",t.current_count),this.inventoryService.syncStock(t.product_id),t.current_count=t.current_count?t.current_count+1:t.current_stock+1,console.log("Se incrementa valor a: ",t.current_count),console.log("Valor Stock: ",t.current_stock)):(console.warn(`No se puede incrementar, valor m\xe1ximo alcanzado (${t.max_amount})`),alert(`Has alcanzado el stock m\xe1ximo permitido: ${t.max_amount}`))}decreaseCount(t){this.inventoryService.syncStock(t.product_id),t.current_count>0&&(console.log("Se decrementa valor de: ",t.current_count),t.current_count--,console.log("Se decrementa valor de: ",t.current_count),console.log("Valor Stock: ",t.current_stock))}confirmAction(t){const i=t.current_count-t.current_stock;0!==i?this.inventoryService.updateInventory(t.product_id,i).subscribe({next:r=>{r.success?(console.log("Stock actualizado correctamente:",r.new_stock),t.current_stock=r.new_stock,t.current_count=r.new_stock):console.warn("Error al actualizar el stock:",r.message)},error:r=>{console.error("Error al realizar la solicitud:",r)}}):console.log("Sin cambios en el stock.")}getButtonColor(t){return t.current_count>t.current_stock?"success":t.current_count<t.current_stock?"danger":"medium"}getDynamicText(t){return t.current_count>t.current_stock?"Agregar a Stock":t.current_count<t.current_stock?"Venta":t.current_count===t.current_stock?"Stock Disponible":"None"}initializeProducts(t){typeof t.current_stock<"u"?(t.current_count=t.current_stock,console.log("stock:",t.current_stock),console.log("count:",t.current_count)):(console.warn("current_stock no est\xe1 definido para el producto:",t),t.current_count=0)}onDrag(t){setTimeout(()=>{t.close()},300)}}return(e=a).\u0275fac=function(t){return new(t||e)(n.rXU(d.c),n.rXU(m.Ix),n.rXU(f.u))},e.\u0275cmp=n.VBU({type:e,selectors:[["app-inventario"]],decls:8,vars:2,consts:[["slidingItem",""],["placeholder","Buscar por ID, Nombre o Proveedor",3,"ngModelChange","ionInput","ngModel"],[4,"ngFor","ngForOf"],[1,"inventory-item"],[1,"left-info"],["slot","start"],["src","assets/product_placeholder.png",3,"alt"],[1,"product-name"],[1,"counter-container"],[1,"dynamic-text"],[1,"counter-controls"],["fill","clear","size","small",3,"color","click",4,"ngIf"],[1,"counter-value-container"],[1,"counter-value"],["class","warning-text",4,"ngIf"],["expand","block","size","small","class","confirm-button",3,"color","click",4,"ngIf"],["side","end",3,"ionDrag",4,"ngIf"],["fill","clear","size","small",3,"click","color"],["name","remove-circle-outline"],[1,"warning-text"],["name","add-circle-outline"],["expand","block","size","small",1,"confirm-button",3,"click","color"],["side","end",3,"ionDrag"],["color","primary",3,"click"]],template:function(t,i){1&t&&(n.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),n.EFF(3,"Inventario"),n.k0s()()(),n.j41(4,"ion-content")(5,"ion-list")(6,"ion-searchbar",1),n.mxI("ngModelChange",function(l){return n.DH7(i.searchTerm,l)||(i.searchTerm=l),l}),n.bIt("ionInput",function(l){return i.onSearchChange(l)}),n.k0s(),n.DNE(7,C,25,11,"ion-item-sliding",2),n.k0s()()),2&t&&(n.R7$(6),n.R50("ngModel",i.searchTerm),n.R7$(),n.Y8G("ngForOf",i.filteredProducts))},dependencies:[u.Sq,u.bT,_.BC,_.vS,c.Jm,c.W9,c.eU,c.iq,c.KW,c.uz,c.LU,c.CE,c.A7,c.he,c.nf,c.S1,c.Zx,c.BC,c.ai,c.Gw],styles:['@charset "UTF-8";ion-list[_ngcontent-%COMP%]{margin:10px;border-radius:15px;overflow:hidden;background-color:#fff;box-shadow:0 2px 8px #0000001a}ion-item[_ngcontent-%COMP%]{--background: #fff;margin:5px 0;border-radius:10px;padding:0 10px;display:flex;align-items:center;transition:transform .2s ease,box-shadow .2s ease}ion-item[_ngcontent-%COMP%]:hover{transform:scale(1.02);box-shadow:0 4px 12px #00000026}ion-thumbnail[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:10px;overflow:hidden}ion-img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%}ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#333;margin:0}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;color:#666;margin:2px 0}.product-price[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#444;margin-left:auto;display:flex;align-items:center;justify-content:center}@media (min-width: 768px){.counter-container[_ngcontent-%COMP%]{padding:0 0 10px}ion-list[_ngcontent-%COMP%]{max-width:700px;margin:20px auto}ion-item[_ngcontent-%COMP%]{--background: #f9f9f9;padding:15px}ion-thumbnail[_ngcontent-%COMP%]{width:100px;height:100px}ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem}.product-price[_ngcontent-%COMP%]{font-size:1.1rem}}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem;color:#666;margin:2px 0}ion-list.list-ios[_ngcontent-%COMP%]   ion-item.item[_ngcontent-%COMP%]   div.item-native[_ngcontent-%COMP%]{border-bottom:none}.counter-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-left:auto;flex-direction:column;justify-content:space-evenly;height:100%;padding:10px 0}.counter-container[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0}.small-text[_ngcontent-%COMP%]{font-size:.8rem;color:var(--ion-color-medium);text-align:center}.confirm-button[_ngcontent-%COMP%]{transition:transform .2s}.confirm-button[_ngcontent-%COMP%]:active{transform:scale(1.1)}.current-stk[_ngcontent-%COMP%]{display:flex;height:100%;justify-content:space-evenly;align-items:center}.dynamic-text[_ngcontent-%COMP%]{width:150px;text-align:center;font-size:.9rem;font-weight:700;min-height:1.5rem}.container-stock[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-evenly}.mid-two[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-around;height:100%}.inventory-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.counter-controls[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:10px}.counter-value-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;min-width:70px}.counter-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--ion-color-medium)}.stock-label[_ngcontent-%COMP%]{font-size:.8rem;color:var(--ion-color-medium)}.dynamic-text[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700;color:var(--ion-color-primary)}.confirm-button[_ngcontent-%COMP%]{width:100%;max-width:80px;margin-top:5px;transition:transform .2s}.confirm-button[_ngcontent-%COMP%]:active{transform:scale(1.05)}.confirm-button[_ngcontent-%COMP%]::navitve{color:#fff}.left-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;align-items:center;justify-content:flex-start}ion-thumbnail[_ngcontent-%COMP%]{padding:7px;margin-right:20px}@media (max-width: 450px){.left-info[_ngcontent-%COMP%]{flex-direction:column;align-items:center}ion-label[_ngcontent-%COMP%]{text-align:center}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.75rem;text-align:center}ion-list[_ngcontent-%COMP%]{max-width:700px;margin:10px auto 0}}ion-item.inventory-item[_ngcontent-%COMP%]::part(native){padding-left:0}.warning-text[_ngcontent-%COMP%]{color:red;font-size:.6rem;text-align:center;margin-top:5px}']}),a})()}];let b=(()=>{var e;class a{}return(e=a).\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.$C({type:e}),e.\u0275inj=n.G2t({imports:[m.iI.forChild(M),m.iI]}),a})(),k=(()=>{var e;class a{}return(e=a).\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.$C({type:e}),e.\u0275inj=n.G2t({imports:[u.MD,_.YN,c.bv,b]}),a})()}}]);