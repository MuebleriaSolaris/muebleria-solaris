"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9844],{9844:(R,g,c)=>{c.r(g),c.d(g,{UsuariosSistemaPageModule:()=>C});var d=c(177),p=c(4341),a=c(7125),l=c(620),m=c(467),e=c(4438),h=c(4796),f=c(1626);function P(s,r){1&s&&(e.j41(0,"span"),e.EFF(1,"Administrador"),e.k0s())}function x(s,r){1&s&&(e.j41(0,"span"),e.EFF(1,"Vendedor"),e.k0s())}function U(s,r){1&s&&(e.j41(0,"span"),e.EFF(1,"Desconocido"),e.k0s())}function _(s,r){1&s&&(e.j41(0,"span"),e.EFF(1,"Gerente"),e.k0s())}function v(s,r){if(1&s){const o=e.RV6();e.j41(0,"ion-item-sliding")(1,"ion-item",3)(2,"ion-thumbnail",4),e.nrm(3,"img",5),e.k0s(),e.j41(4,"ion-label")(5,"h2"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.k0s(),e.j41(9,"p"),e.EFF(10,"Rol: "),e.DNE(11,P,2,0,"span",6)(12,x,2,0,"span",6)(13,U,2,0,"span",6)(14,_,2,0,"span",6),e.k0s()()(),e.j41(15,"ion-item-options",7)(16,"ion-item-option",8),e.bIt("click",function(){const t=e.eBV(o).$implicit,i=e.XpG();return e.Njj(i.viewUserDetails(t.id))}),e.EFF(17," Ver Detalles "),e.k0s()()()}if(2&s){const o=r.$implicit,n=e.XpG();e.R7$(3),e.FS9("alt",o.name),e.R7$(3),e.JRh(o.name),e.R7$(2),e.SpI("Usuario: ",o.username,""),e.R7$(3),e.Y8G("ngIf",1===o.role&&!1===n.userRoles[o.id]),e.R7$(),e.Y8G("ngIf",4===o.role),e.R7$(),e.Y8G("ngIf",1!==o.role&&4!==o.role),e.R7$(),e.Y8G("ngIf",1===o.role&&!0===n.userRoles[o.id])}}const M=[{path:"",component:(()=>{var s;class r{constructor(n,t,i,u){this.authService=n,this.route=t,this.router=i,this.http=u,this.users=[],this.userId="",this.esGerente=!1,this.userRoles={}}ngOnInit(){this.loadUsers()}loadUsers(){var t,n=this;this.authService.getUsers().subscribe({next:(t=(0,m.A)(function*(i){"success"===i.status?(n.users=i.data,yield n.checkGerentes()):console.error("Error del servidor:",i.message)}),function(u){return t.apply(this,arguments)}),error:t=>{console.error("Error de conexi\xf3n:",t)}})}checkGerentes(){var n=this;return(0,m.A)(function*(){if(console.log("[checkGerentes] Iniciando verificaci\xf3n de gerentes"),n.userRoles={},n.users&&0!==n.users.length){console.log(`[checkGerentes] Usuarios a verificar: ${n.users.length}`);for(const t of n.users)try{console.log(`[checkGerentes] Verificando usuario ID: ${t.id}, Nombre: ${t.name}`);const i=`https://muebleriasolaris.com/ionic-login/check_gerencia.php?userid=${t.id}`;console.log(`[checkGerentes] URL de la API: ${i}`);const u=yield n.http.get(i).toPromise();if(console.log("[checkGerentes] Respuesta de la API:",u),!u){console.error("[checkGerentes] La respuesta est\xe1 vac\xeda"),n.userRoles[t.id]=!1;continue}typeof u.success>"u"&&console.warn('[checkGerentes] La respuesta no tiene propiedad "success"'),typeof u.isGerente>"u"&&console.warn('[checkGerentes] La respuesta no tiene propiedad "isGerente"'),n.userRoles[t.id]=u.success&&u.isGerente,console.log(`[checkGerentes] Usuario ID ${t.id} es gerente: ${n.userRoles[t.id]}`)}catch(i){console.error(`[checkGerentes] Error verificando gerente para usuario ${t.id}:`,i),n.userRoles[t.id]=!1}console.log("[checkGerentes] Resultado final:",n.userRoles)}else console.warn("[checkGerentes] No hay usuarios para verificar")})()}viewUserDetails(n){this.router.navigate(["/usuarios-info",n])}}return(s=r).\u0275fac=function(n){return new(n||s)(e.rXU(h.u),e.rXU(l.nX),e.rXU(l.Ix),e.rXU(f.Qq))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-usuarios-sistema"]],decls:7,vars:1,consts:[["color","primary"],[1,"user-list"],[4,"ngFor","ngForOf"],[1,"user-card"],["slot","start"],["src","assets/user_src.png",3,"alt"],[4,"ngIf"],["side","end"],["color","primary",3,"click"]],template:function(n,t){1&n&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e.EFF(3,"Usuarios del Sistema"),e.k0s()()(),e.j41(4,"ion-content")(5,"ion-list",1),e.DNE(6,v,18,7,"ion-item-sliding",2),e.k0s()()),2&n&&(e.R7$(6),e.Y8G("ngForOf",t.users))},dependencies:[d.Sq,d.bT,a.W9,a.eU,a.uz,a.LU,a.CE,a.A7,a.he,a.nf,a.Zx,a.BC,a.ai],styles:['@charset "UTF-8";.user-list[_ngcontent-%COMP%]{margin:0 auto;padding:10px;width:100%;max-width:450px}.user-card[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:10px;margin:8px 0;padding:10px;background-color:#fff;box-shadow:0 2px 4px #0000001a;transition:transform .2s ease,box-shadow .2s ease}.user-card[_ngcontent-%COMP%]:hover{transform:scale(1.02);box-shadow:0 4px 8px #0003}ion-thumbnail[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;margin-right:10px;overflow:hidden}ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%}.user-name[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;color:#333;margin:0}.user-role[_ngcontent-%COMP%]{font-size:.9rem;color:#666;margin:2px 0}ion-item-sliding[_ngcontent-%COMP%]{margin:8px 0;border-radius:10px;overflow:hidden}ion-item-options[_ngcontent-%COMP%]{border-radius:10px;overflow:hidden}ion-item-option[_ngcontent-%COMP%]{text-align:center;padding:10px 0}.user-card[_ngcontent-%COMP%]{--box-shadow: none}ion-item.user-card[_ngcontent-%COMP%]{border:none!important;--ion-border-color: transparent}@media (max-width: 576px){.user-card[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:center}ion-thumbnail[_ngcontent-%COMP%]{margin-bottom:10px}ion-item.user-card[_ngcontent-%COMP%]{border:none!important;--ion-border-color: transparent}}ion-icon[name=star][_ngcontent-%COMP%]{color:var(--ion-color-warning)}ion-icon[name=star-outline][_ngcontent-%COMP%]{color:var(--ion-color-medium)}.user-name[_ngcontent-%COMP%]{font-weight:500;margin-bottom:4px}.gerente-true[_ngcontent-%COMP%]{background:rgba(var(--ion-color-warning-rgb),.1)}']}),r})()}];let G=(()=>{var s;class r{}return(s=r).\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[l.iI.forChild(M),l.iI]}),r})(),C=(()=>{var s;class r{}return(s=r).\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[d.MD,p.YN,a.bv,G]}),r})()}}]);