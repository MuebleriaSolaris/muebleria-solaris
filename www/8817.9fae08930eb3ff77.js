"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8817],{8817:(y,m,c)=>{c.r(m),c.d(m,{ClientesPageModule:()=>w});var g=c(177),d=c(4341),i=c(7125),p=c(5520),u=c(1626),t=c(4438),C=c(4796);let h=(()=>{var o;class a{constructor(){}ngOnInit(){}}return(o=a).\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.VBU({type:o,selectors:[["app-footer"]],decls:4,vars:0,consts:[[1,"custom-footer"],[1,"footer-title"]],template:function(n,e){1&n&&(t.j41(0,"ion-footer",0)(1,"ion-toolbar")(2,"ion-title",1),t.EFF(3,"Copyright \xa9 2024 Muebleria Solaris"),t.k0s()()())},dependencies:[i.M0,i.BC,i.ai],styles:['@charset "UTF-8";.footer-title[_ngcontent-%COMP%]{font-size:.8rem;font-weight:400;text-align:center}.footer-top[_ngcontent-%COMP%]{margin-top:20px}@media (max-width: 770px){ion-footer[_ngcontent-%COMP%]{display:none}}']}),a})();function f(o,a){if(1&o){const r=t.RV6();t.j41(0,"ion-button",18),t.bIt("click",function(){t.eBV(r);const e=t.XpG();return t.Njj(e.goToAddClient())}),t.nrm(1,"ion-icon",19),t.EFF(2," Agregar Cliente "),t.k0s()}}function _(o,a){1&o&&(t.j41(0,"ion-badge",24),t.EFF(1," Actualizado "),t.k0s())}function P(o,a){if(1&o){const r=t.RV6();t.j41(0,"ion-item-options",25)(1,"ion-item-option",26),t.bIt("click",function(){t.eBV(r);const e=t.XpG().$implicit,s=t.XpG();return t.Njj(s.viewCustomerDetails(e.id))}),t.EFF(2," Ver Perfil "),t.k0s()()}}function M(o,a){if(1&o&&(t.j41(0,"ion-item-sliding")(1,"ion-item",20)(2,"ion-col",6),t.EFF(3),t.k0s(),t.j41(4,"ion-col",7),t.EFF(5),t.k0s(),t.j41(6,"ion-col",8),t.EFF(7),t.DNE(8,_,2,0,"ion-badge",21),t.k0s(),t.j41(9,"ion-col",9)(10,"span",22),t.EFF(11),t.k0s()()(),t.DNE(12,P,3,0,"ion-item-options",23),t.k0s()),2&o){const r=a.$implicit,n=t.XpG();t.R7$(3),t.JRh(null==r?null:r.name),t.R7$(2),t.JRh(r.address),t.R7$(2),t.SpI(" ",r.phone," "),t.R7$(),t.Y8G("ngIf",r.has_pending_changes),t.R7$(2),t.Y8G("ngClass",n.getCustomerTypeClass(r.type)),t.R7$(),t.SpI(" ",n.getCustomerTypeName(r.type)," "),t.R7$(),t.Y8G("ngIf",n.isAdmin)}}function x(o,a){1&o&&(t.j41(0,"div",27),t.nrm(1,"ion-spinner",28),t.k0s())}const O=[{path:"",component:(()=>{var o;class a{constructor(n,e,s){this.http=n,this.authService=e,this.router=s,this.customers=[],this.paginatedCustomers=[],this.itemsPerPage=10,this.currentPage=1,this.searchTerm="",this.isAdmin=!1,this.selectedCustomerId=null,this.totalCount=0,this.showingCount=0,this.loading=!1}ngOnInit(){this.loadCustomers(),this.isAdmin=this.authService.isAdmin()}loadCustomers(n=1){this.loading=!0,this.currentPage=n;let e="https://muebleriasolaris.com/ionic-users/clientes.php",s=(new u.Nl).set("page",n.toString());this.searchTerm.trim()&&(e="https://muebleriasolaris.com/ionic-users/clientes_search.php",s=s.set("search",this.searchTerm.trim())),this.http.get(e,{params:s}).subscribe(l=>{this.customers=l.data||[],this.totalCount=l.total||0,this.loading=!1},l=>{console.error("Error al cargar clientes:",l),this.loading=!1})}selectCustomer(n){this.selectedCustomerId=this.selectedCustomerId===n?null:n}onSearchInput(){this.loadCustomers(1)}paginateCustomers(){this.paginatedCustomers=this.customers.slice((this.currentPage-1)*this.itemsPerPage,this.currentPage*this.itemsPerPage)}nextPage(){this.currentPage*this.itemsPerPage<this.totalCount&&this.loadCustomers(this.currentPage+1)}prevPage(){this.currentPage>1&&this.loadCustomers(this.currentPage-1)}getCustomerTypeName(n){switch(parseInt(n,10)){case 2:return"Malo";case 1:return"Regular";case 0:return"Bueno";default:return"Desconocido"}}getCustomerTypeClass(n){switch(parseInt(n,10)){case 0:return"success";case 1:return"warning";case 2:return"danger";default:return"medium"}}viewCustomerDetails(n,e){this.isAdmin?(this.selectedCustomerId=n,e&&e.close(),this.router.navigate(["/cliente-info",n])):console.warn("Access denied. Only admins can view customer details.")}goToAddClient(){this.router.navigate(["/agregar-clientes"])}getShowingRange(){return`${(this.currentPage-1)*this.itemsPerPage+1}-${Math.min(this.currentPage*this.itemsPerPage,this.totalCount)}`}formatNumber(n){return n.toLocaleString("es-MX")}}return(o=a).\u0275fac=function(n){return new(n||o)(t.rXU(u.Qq),t.rXU(C.u),t.rXU(p.Ix))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-clientes"]],decls:33,vars:10,consts:[["color","primary"],[1,"search-container"],["placeholder","Buscar por nombre, direcci\xf3n o tel\xe9fono","debounce","500",1,"search-bar",3,"ngModelChange","ionInput","ngModel"],["class","add-client-button","color","primary",3,"click",4,"ngIf"],[1,"customer-table"],[1,"header-row"],[1,"name-col"],[1,"address-col"],[1,"phone-col"],[1,"type-col"],[4,"ngFor","ngForOf"],["class","loading-overlay",4,"ngIf"],[1,"pagination-container"],[1,"results-count"],[1,"pagination-controls"],[3,"click","disabled"],["name","chevron-back-outline"],["name","chevron-forward-outline"],["color","primary",1,"add-client-button",3,"click"],["slot","start","name","add-outline"],[1,"item-val"],["color","warning","style","margin-left: 5px;",4,"ngIf"],[1,"type-label",3,"ngClass"],["side","start",4,"ngIf"],["color","warning",2,"margin-left","5px"],["side","start"],["color","primary",3,"click"],[1,"loading-overlay"],["name","crescent",1,"loading-spinner"]],template:function(n,e){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),t.EFF(3,"Clientes"),t.k0s()()(),t.j41(4,"ion-content")(5,"div",1)(6,"ion-searchbar",2),t.mxI("ngModelChange",function(l){return t.DH7(e.searchTerm,l)||(e.searchTerm=l),l}),t.bIt("ionInput",function(){return e.onSearchInput()}),t.k0s(),t.DNE(7,f,3,0,"ion-button",3),t.k0s(),t.j41(8,"ion-grid",4)(9,"ion-row",5)(10,"ion-col",6)(11,"strong"),t.EFF(12,"Nombre"),t.k0s()(),t.j41(13,"ion-col",7)(14,"strong"),t.EFF(15,"Direcci\xf3n"),t.k0s()(),t.j41(16,"ion-col",8)(17,"strong"),t.EFF(18,"Tel\xe9fono"),t.k0s()(),t.j41(19,"ion-col",9)(20,"strong"),t.EFF(21,"Tipo"),t.k0s()()(),t.DNE(22,M,13,7,"ion-item-sliding",10),t.k0s(),t.DNE(23,x,2,0,"div",11),t.j41(24,"div",12)(25,"div",13),t.EFF(26),t.k0s(),t.j41(27,"div",14)(28,"ion-button",15),t.bIt("click",function(){return e.prevPage()}),t.nrm(29,"ion-icon",16),t.k0s(),t.j41(30,"ion-button",15),t.bIt("click",function(){return e.nextPage()}),t.nrm(31,"ion-icon",17),t.k0s()()()(),t.nrm(32,"app-footer")),2&n&&(t.R7$(5),t.AVh("is-not-admin",e.isAdmin),t.R7$(),t.R50("ngModel",e.searchTerm),t.R7$(),t.Y8G("ngIf",e.isAdmin),t.R7$(15),t.Y8G("ngForOf",e.customers),t.R7$(),t.Y8G("ngIf",e.loading),t.R7$(3),t.Lme(" Mostrando ",e.getShowingRange()," de ",e.formatNumber(e.totalCount)," clientes "),t.R7$(2),t.Y8G("disabled",1===e.currentPage||e.loading),t.R7$(2),t.Y8G("disabled",e.currentPage*e.itemsPerPage>=e.totalCount||e.loading))},dependencies:[g.YU,g.Sq,g.bT,d.BC,d.vS,i.In,i.Jm,i.hU,i.W9,i.lO,i.eU,i.iq,i.uz,i.LU,i.CE,i.A7,i.ln,i.S1,i.w2,i.BC,i.ai,i.Gw,h],styles:['@charset "UTF-8";.customer-table[_ngcontent-%COMP%]{width:100%;margin:0 auto;border-collapse:collapse}.customer-table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{display:flex;align-items:stretch;width:100%}.customer-table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:12px 8px;display:flex;align-items:center;min-width:0}.name-col[_ngcontent-%COMP%], .address-col[_ngcontent-%COMP%]{flex:3;text-align:left;justify-content:center;white-space:normal;word-break:break-word}.phone-col[_ngcontent-%COMP%], .type-col[_ngcontent-%COMP%]{flex:2;text-align:center;justify-content:center;white-space:normal}.header-row[_ngcontent-%COMP%]{background-color:#f0f0f0;font-weight:700;border-bottom:2px solid #ccc}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{font-weight:700;white-space:nowrap}@media (max-width: 576px){.customer-table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{flex-wrap:wrap}.customer-table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:8px 4px;font-size:13px;flex:1 1 50%}.customer-table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col.type-col[_ngcontent-%COMP%], .customer-table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col.phone-col[_ngcontent-%COMP%]{justify-content:flex-start;text-align:left}}.header-row[_ngcontent-%COMP%]{background-color:#f0f0f0;font-weight:700;text-align:center;border-bottom:2px solid #ccc;padding:10px 0}.data-row[_ngcontent-%COMP%]{text-align:center;padding:10px 0}.customer-type[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.type-indicator[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;margin-right:8px;box-shadow:0 4px 8px #0000004d;transition:transform .3s ease,box-shadow .3s ease}.type-indicator[_ngcontent-%COMP%]:hover{transform:scale(1.2);box-shadow:0 6px 12px #0006}.search-bar[_ngcontent-%COMP%]{margin-top:20px}.pagination-controls[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:20px;flex-wrap:wrap}.pagination-controls[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:5px}@media (max-width: 576px){.customer-table[_ngcontent-%COMP%]{width:100%;margin:0}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%], .data-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{font-size:14px}.pagination-controls[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-between;padding:0 10px}.pagination-controls[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:1;margin:5px;min-width:45%;display:block}}@media (max-width: 770px){.item-val[_ngcontent-%COMP%]{font-size:12px}}.cel-center[_ngcontent-%COMP%]{text-align:center}.search-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:10px;background-color:#f4f4f4}.search-bar[_ngcontent-%COMP%]{flex:1}.add-client-button[_ngcontent-%COMP%]{margin-top:20px;white-space:nowrap}@media (max-width: 768px){.search-container[_ngcontent-%COMP%]{flex-direction:column-reverse}.search-bar[_ngcontent-%COMP%]{margin-top:10px;width:100%;padding-bottom:0}.add-client-button[_ngcontent-%COMP%]{padding:0 10px;width:100%}.is-not-admin[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{padding-top:15px}.is-not-admin[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]{padding-bottom:0}}.item-selected[_ngcontent-%COMP%]{background-color:#0000000d!important;transition:background-color .2s ease}.item-val[_ngcontent-%COMP%]{--background: transparent;--border-color: transparent;cursor:pointer;transition:background-color .2s ease}.item-val[_ngcontent-%COMP%]:hover{background-color:#0000001a}.customer-table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{display:flex;align-items:stretch}.customer-table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}ion-item-sliding.active-slide[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{transform:translate(-100px)}ion-item-sliding.active-slide[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{opacity:.9}@media (max-width: 576px){ion-item-sliding[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--min-height: 50px}ion-item-sliding[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:8px 4px;font-size:13px}ion-item-sliding[_ngcontent-%COMP%]   ion-item-options[_ngcontent-%COMP%]   ion-item-option[_ngcontent-%COMP%]{width:80px;font-size:13px}}.customer-table[_ngcontent-%COMP%]{width:100%;margin:0 auto;text-align:center;border-collapse:collapse}.customer-table[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]{background-color:#f0f0f0;font-weight:700;text-align:center;border-bottom:2px solid #ccc;padding:10px 0}.customer-table[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{font-weight:700}.type-label[_ngcontent-%COMP%]{display:inline-block;padding:4px 10px;color:#fff;font-weight:700;border-radius:12px;text-align:center;min-width:60px}.type-label.success[_ngcontent-%COMP%]{background-color:#4caf50}.type-label.warning[_ngcontent-%COMP%]{background-color:#1e3a8a}.type-label.danger[_ngcontent-%COMP%]{background-color:#cb2a2a}.type-label.medium[_ngcontent-%COMP%]{background-color:#9e9e9e}.pagination-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:20px;padding:0 16px;flex-wrap:wrap}.results-count[_ngcontent-%COMP%]{font-size:14px;color:#666;padding:8px 0}.pagination-controls[_ngcontent-%COMP%]{display:flex;gap:8px}@media (max-width: 576px){.pagination-container[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.results-count[_ngcontent-%COMP%]{order:1;width:100%;text-align:center}.pagination-controls[_ngcontent-%COMP%]{width:100%;justify-content:center}}.text-left[_ngcontent-%COMP%]{text-align:left;justify-content:flex-start;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.results-count[_ngcontent-%COMP%]{font-size:14px}.results-count[_ngcontent-%COMP%]     .number{font-weight:700}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1000;display:flex;justify-content:center;align-items:center;width:100%;height:100%;background-color:#ffffffb3}.loading-spinner[_ngcontent-%COMP%]{width:64px;height:64px;color:var(--ion-color-primary)}']}),a})()}];let b=(()=>{var o;class a{}return(o=a).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[p.iI.forChild(O),p.iI]}),a})(),w=(()=>{var o;class a{}return(o=a).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[g.MD,d.YN,i.bv,b]}),a})()}}]);