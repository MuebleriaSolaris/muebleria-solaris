"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[301],{301:(v,d,l)=>{l.r(d),l.d(d,{ClienteInfoPageModule:()=>E});var u=l(177),c=l(4341),s=l(7125),f=l(620),e=l(4438),m=l(1626);const g=o=>({"font-weight":o});function p(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-item"),e.nrm(1,"ion-icon",22),e.j41(2,"ion-label")(3,"h2"),e.EFF(4,"Nombre"),e.k0s(),e.j41(5,"input",29),e.mxI("ngModelChange",function(n){e.eBV(i);const r=e.XpG(2);return e.DH7(r.customerInfo.name,n)||(r.customerInfo.name=n),e.Njj(n)}),e.k0s()()()}if(2&o){const i=e.XpG(2);e.R7$(5),e.R50("ngModel",i.customerInfo.name)}}function _(o,a){if(1&o){const i=e.RV6();e.qex(0),e.j41(1,"input",30),e.mxI("ngModelChange",function(n){e.eBV(i);const r=e.XpG(2);return e.DH7(r.customerInfo.address,n)||(r.customerInfo.address=n),e.Njj(n)}),e.k0s(),e.bVm()}if(2&o){const i=e.XpG(2);e.R7$(),e.R50("ngModel",i.customerInfo.address)}}function h(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-input",31),e.mxI("ngModelChange",function(n){e.eBV(i);const r=e.XpG(2);return e.DH7(r.customerInfo.address,n)||(r.customerInfo.address=n),e.Njj(n)}),e.k0s()}if(2&o){const i=e.XpG(2);e.R50("ngModel",i.customerInfo.address)}}function I(o,a){if(1&o&&(e.j41(0,"p"),e.EFF(1),e.k0s()),2&o){const i=e.XpG(2);e.R7$(),e.JRh(0===(null==i.customerInfo?null:i.customerInfo.type)?"Bueno":2===(null==i.customerInfo?null:i.customerInfo.type)?"Malo":"Regular")}}function C(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-select",32),e.mxI("ngModelChange",function(n){e.eBV(i);const r=e.XpG(2);return e.DH7(r.customerInfo.type,n)||(r.customerInfo.type=n),e.Njj(n)}),e.j41(1,"ion-select-option",33),e.EFF(2,"Bueno"),e.k0s(),e.j41(3,"ion-select-option",34),e.EFF(4,"Regular"),e.k0s(),e.j41(5,"ion-select-option",35),e.EFF(6,"Malo"),e.k0s()()}if(2&o){const i=e.XpG(2);e.R50("ngModel",i.customerInfo.type)}}function b(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-footer",36)(1,"div",37)(2,"ion-button",38),e.nrm(3,"ion-icon",39),e.EFF(4," Guardar "),e.k0s(),e.j41(5,"ion-button",40),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.cancelEdit())}),e.nrm(6,"ion-icon",41),e.EFF(7," Cancelar "),e.k0s()()()}}function x(o,a){if(1&o){const i=e.RV6();e.j41(0,"form",3,0),e.bIt("ngSubmit",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.saveChanges())}),e.j41(2,"div",4)(3,"ion-avatar",5),e.nrm(4,"img",6),e.k0s(),e.j41(5,"h2"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.k0s()(),e.j41(9,"div",7)(10,"ion-button",8),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.goBack())}),e.nrm(11,"ion-icon",9),e.EFF(12," Regresar "),e.k0s(),e.j41(13,"ion-button",10),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.toggleEditMode())}),e.nrm(14,"ion-icon",11),e.EFF(15," Editar "),e.k0s(),e.j41(16,"ion-button",12),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.confirmDelete())}),e.nrm(17,"ion-icon",13),e.EFF(18," Eliminar "),e.k0s()(),e.j41(19,"div",14)(20,"div",15)(21,"h3"),e.EFF(22,"Detalles del Cliente"),e.k0s()(),e.j41(23,"ion-list",16),e.DNE(24,p,6,1,"ion-item",17),e.j41(25,"ion-item"),e.nrm(26,"ion-icon",18),e.j41(27,"ion-label")(28,"h2"),e.EFF(29,"Direcci\xf3n"),e.k0s(),e.DNE(30,_,2,1,"ng-container",19)(31,h,1,1,"ng-template",null,1,e.C5r),e.k0s()(),e.j41(33,"ion-item"),e.nrm(34,"ion-icon",20),e.j41(35,"ion-label")(36,"h2"),e.EFF(37,"Tel\xe9fono"),e.k0s(),e.j41(38,"ion-input",21),e.mxI("ngModelChange",function(n){e.eBV(i);const r=e.XpG();return e.DH7(r.customerInfo.phone,n)||(r.customerInfo.phone=n),e.Njj(n)}),e.bIt("ionInput",function(n){e.eBV(i);const r=e.XpG();return e.Njj(r.filterNumbers(n))}),e.k0s()()(),e.j41(39,"ion-item"),e.nrm(40,"ion-icon",22),e.j41(41,"ion-label")(42,"h2",23),e.EFF(43,"Tipo de Cliente"),e.k0s(),e.DNE(44,I,2,1,"p",17)(45,C,7,1,"ion-select",24),e.k0s()(),e.j41(46,"ion-item"),e.nrm(47,"ion-icon",25),e.j41(48,"ion-label")(49,"h2"),e.EFF(50,"\xdaltima Actualizaci\xf3n"),e.k0s(),e.j41(51,"p"),e.EFF(52),e.k0s()(),e.j41(53,"ion-button",26),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.viewCustomerHistory())}),e.nrm(54,"ion-icon",27),e.EFF(55," Historial "),e.k0s()()(),e.DNE(56,b,8,0,"ion-footer",28),e.k0s()()}if(2&o){const i=e.sdS(32),t=e.XpG();e.R7$(6),e.JRh(t.customerInfo.name),e.R7$(2),e.JRh(t.customerInfo.phone),e.R7$(16),e.Y8G("ngIf",t.isEditMode),e.R7$(6),e.Y8G("ngIf",t.isEditMode)("ngIfElse",i),e.R7$(8),e.R50("ngModel",t.customerInfo.phone),e.Y8G("readonly",!t.isEditMode),e.R7$(4),e.Y8G("ngStyle",e.eq3(12,g,t.isEditMode?"bold":"normal")),e.R7$(2),e.Y8G("ngIf",!t.isEditMode),e.R7$(),e.Y8G("ngIf",t.isEditMode),e.R7$(7),e.JRh(null==t.customerInfo?null:t.customerInfo.updated_at),e.R7$(4),e.Y8G("ngIf",t.isEditMode)}}const M=[{path:"",component:(()=>{var o;class a{constructor(t,n,r,P,k,F){this.route=t,this.http=n,this.router=r,this.alertController=P,this.toastController=k,this.location=F,this.customerInfo=null,this.isEditMode=!1,this.originalCustomerInfo=null}ngOnInit(){const t=this.route.snapshot.paramMap.get("id");t&&this.fetchCustomerInfo(t)}fetchCustomerInfo(t){this.http.get(`https://muebleriasolaris.com/ionic-users/cliente_id_info.php?id=${t}`).subscribe({next:n=>{"success"===n.status?(this.customerInfo=n.data,this.originalCustomerInfo=JSON.parse(JSON.stringify(n.data))):console.error("Failed to fetch customer information")},error:n=>{console.error("Error fetching customer info:",n)}})}toggleEditMode(){this.isEditMode=!this.isEditMode,this.isEditMode&&this.customerInfo?this.customerInfo.updated_at=(new Date).toLocaleString():this.isEditMode||(this.customerInfo=JSON.parse(JSON.stringify(this.originalCustomerInfo)))}saveChanges(){var t;this.customerInfo&&this.alertController.create({header:"Confirmar actualizaci\xf3n",message:`\xbfEst\xe1s seguro de que deseas actualizar a ${null===(t=this.customerInfo)||void 0===t?void 0:t.name}?`,buttons:[{text:"Cancelar",role:"cancel",cssClass:"secondary"},{text:"Actualizar",handler:()=>{this.confirmchanges()}}]}).then(r=>r.present())}confirmchanges(){console.log("Customer Info to be updated:",this.customerInfo),this.http.post("https://muebleriasolaris.com/ionic-users/update_cliente_info.php",this.customerInfo).subscribe({next:()=>{console.log("Customer info updated successfully"),this.isEditMode=!1,this.originalCustomerInfo=JSON.parse(JSON.stringify(this.customerInfo)),this.toastController.create({message:"Cliente actualizado exitosamente.",duration:2e3,color:"success"}).then(t=>t.present()),setTimeout(()=>{this.location.go("/clientes"),window.location.reload()},1e3)},error:t=>{console.error("Error updating customer info:",t)}})}cancelEdit(){this.originalCustomerInfo&&(this.customerInfo=JSON.parse(JSON.stringify(this.originalCustomerInfo))),this.isEditMode=!1}goBack(){this.router.navigate(["/clientes"])}getCustomerTypeText(t){switch(t){case 1:return"Bueno";case 2:return"Regular";case 0:return"Malo";default:return"Desconocido"}}viewCustomerHistory(){var t;null!==(t=this.customerInfo)&&void 0!==t&&t.id?this.router.navigate(["/historial-cliente",this.customerInfo.id]):console.error("El ID del cliente no est\xe1 definido")}confirmDelete(){var t;this.alertController.create({header:"Confirmar eliminaci\xf3n",message:`\xbfEst\xe1s seguro de que deseas eliminar a ${null===(t=this.customerInfo)||void 0===t?void 0:t.name}?`,buttons:[{text:"Cancelar",role:"cancel",cssClass:"secondary"},{text:"Eliminar",handler:()=>{this.deleteCustomer()}}]}).then(r=>r.present())}deleteCustomer(){var t;this.http.post("https://muebleriasolaris.com/ionic-users/delete_cliente.php",{id:null===(t=this.customerInfo)||void 0===t?void 0:t.id}).subscribe({next:()=>{this.toastController.create({message:"Cliente eliminado exitosamente.",duration:4e3,color:"success"}).then(n=>n.present()),setTimeout(()=>{this.location.go("/clientes"),window.location.reload()},1e3)},error:n=>{console.error("Error eliminando cliente:",n),this.toastController.create({message:"Error al eliminar cliente. Intenta nuevamente.",duration:2e3,color:"danger"}).then(r=>r.present())}})}filterNumbers(t){if(this.isEditMode){const n=t.target;let r=n.value.replace(/[^0-9]/g,"");this.customerInfo&&(this.customerInfo.phone=r),n.value=r}}}return(o=a).\u0275fac=function(t){return new(t||o)(e.rXU(f.nX),e.rXU(m.Qq),e.rXU(f.Ix),e.rXU(s.hG),e.rXU(s.K_),e.rXU(u.aZ))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-cliente-info"]],decls:6,vars:1,consts:[["updateForm","ngForm"],["showIonInput",""],[3,"ngSubmit",4,"ngIf"],[3,"ngSubmit"],[1,"profile-header"],[1,"profile-avatar"],["src","assets/user_src.png","alt","Client Picture"],[1,"top-button-container"],["color","light",1,"regresar-button",3,"click"],["name","arrow-back-outline","slot","start"],["color","secondary",3,"click"],["name","create-outline","slot","start"],["color","danger",3,"click"],["name","trash-outline","slot","start"],[1,"account-info"],[1,"top-cliente"],["lines","none"],[4,"ngIf"],["name","location-outline","slot","start"],[4,"ngIf","ngIfElse"],["name","call-outline","slot","start"],["name","phone","placeholder","Tel\xe9fono","required","","type","tel",3,"ngModelChange","ionInput","ngModel","readonly"],["name","person-outline","slot","start"],[3,"ngStyle"],[3,"ngModel","ngModelChange",4,"ngIf"],["name","time-outline","slot","start"],["expand","block","color","success",1,"ver-historial",3,"click"],["slot","start","name","eye"],["class","edit-footer",4,"ngIf"],["type","text","name","name","placeholder","Nombre","required","",1,"ion-input","native-input",3,"ngModelChange","ngModel"],["type","text","name","address","placeholder","Direcci\xf3n","required","",1,"ion-input","native-input",3,"ngModelChange","ngModel"],["name","address","placeholder","Direcci\xf3n",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["value","0"],["value","1"],["value","2"],[1,"edit-footer"],[1,"bottom-action-buttons"],["type","submit","expand","block","color","success",1,"guardar-button"],["slot","start","name","checkmark-outline"],["type","button","expand","block","color","danger",1,"cancelar-button",3,"click"],["slot","start","name","close-outline"]],template:function(t,n){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Actualizar Informaci\xf3n del Cliente"),e.k0s()()(),e.j41(4,"ion-content"),e.DNE(5,x,57,14,"form",2),e.k0s()),2&t&&(e.R7$(5),e.Y8G("ngIf",n.customerInfo))},dependencies:[u.bT,u.B3,c.qT,c.me,c.BC,c.cb,c.YS,c.vS,c.cV,s.mC,s.Jm,s.W9,s.M0,s.eU,s.iq,s.$w,s.uz,s.he,s.nf,s.Nm,s.Ip,s.BC,s.ai,s.Je,s.Gw],styles:["ion-content[_ngcontent-%COMP%]{--background: #f7f7f7}.profile-header[_ngcontent-%COMP%]{text-align:center;padding:50px 20px;background:linear-gradient(to bottom,#3880ff,#dfdfdf);color:#fff;border-bottom-left-radius:20px;border-bottom-right-radius:20px;display:flex;flex-direction:column;align-items:center;justify-content:center;max-width:800px;margin:0 auto}.profile-avatar[_ngcontent-%COMP%]{width:120px;height:120px;margin-bottom:10px;border-radius:50%;overflow:hidden;border:3px solid white}.top-button-container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;padding:10px 0;background:#3880ff;border-bottom-left-radius:20px;border-bottom-right-radius:20px;max-width:800px;margin:-20px auto 0}.top-button-container[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:auto;font-size:.9rem}.regresar-button[_ngcontent-%COMP%]::part(native){background-color:#fff!important;color:#2f4f4f}.account-info[_ngcontent-%COMP%]{padding:30px;margin:30px 0 0;background:#fff;border-radius:15px;box-shadow:0 4px 8px #0000001a;max-width:700px;text-align:left}ion-list[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem;color:#333;margin-bottom:5px}ion-list[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:4px;font-size:.9rem;color:#666}.bottom-action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:20px 0 10px;margin:0 auto;max-width:700px}.bottom-action-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:1;margin:0 10px;font-weight:700;color:#fff;--border-radius: 8px;--padding: 10px 0}.guardar-button[_ngcontent-%COMP%]::part(native){--background: linear-gradient(to right, #28a745, #218838);color:#fff}.cancelar-button[_ngcontent-%COMP%]::part(native){--background: linear-gradient(to right, #dc3545, #c82333)}@media (min-width: 768px){.profile-header[_ngcontent-%COMP%], .account-info[_ngcontent-%COMP%], .top-button-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;font-size:.78rem}.top-button-container[_ngcontent-%COMP%]{margin-top:-15px}}.ver-historial[_ngcontent-%COMP%]::part(native){--background-color: linear-gradient(to right, #3880ff, #8fb1ee);padding:8px;color:#fff}.edit-footer[_ngcontent-%COMP%]{box-shadow:none}"]}),a})()}];let j=(()=>{var o;class a{}return(o=a).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[f.iI.forChild(M),f.iI]}),a})(),E=(()=>{var o;class a{}return(o=a).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[u.MD,c.YN,s.bv,j]}),a})()}}]);